<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bakes-Villa - Artisan Cakes</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><style>@font-face {font-family: 'Satisfy'; src: url('https://fonts.gstatic.com/s/satisfy/v16/rP2Fp2AHaPq3iFqWlE4D-w.woff2') format('woff2');} text {font-family: 'Satisfy'; font-size: 50px; font-weight: 700; fill: %23A37D45;}</style><text x=%2250%%22 y=%2265%%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22>BV</text></svg>">
    
    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

        const SUPABASE_URL = 'https://pbdibajhxdvotlppvfmz.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBiZGliYWpoeGR2b3RscHB2Zm16Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAxMjQ1NTYsImV4cCI6MjA3NTcwMDU1Nn0.MEP7RhOQTOr2ZNbkfJwTGyNd-44dm5UWSVtrEajFZlY';
        
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        window.supabaseClient = supabase;
        window.SUPABASE_TABLE_NAME = 'Bakes-Villa';
        
        window.onloadCallback = function() {
            if (typeof window.initializeApp === 'function') {
                window.initializeApp();
            }
        }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Satisfy&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        heading: ['Satisfy', 'cursive'],
                        body: ['Quicksand', 'sans-serif'],
                    },
                    colors: {
                        'cream-bg': '#FCF9F3',
                        'cream-light': '#FFFCF5',
                        'brown-primary': '#A37D45',
                        'brown-dark': '#72543D',
                        'gray-dark': '#333333',
                    }
                }
            }
        }
    </script>
    
    <style>
        :root {
            --color-bg-main: #F5F0EA;
            --color-bg-surface: #FFFCF5;
            --color-primary: #A37D45; 
            --color-secondary: #72543D;
            --color-text-dark: #1a1a1a;
            --color-primary-shadow: rgba(163, 125, 69, 0.3);
        }
        
        .dark {
            --color-bg-main: #1A1A1A;
            --color-bg-surface: #2A2A2A;
            --color-primary: #F0E5D4;
            --color-secondary: #A37D45;
            --color-text-dark: #F0E5D4;
            --color-primary-shadow: rgba(240, 229, 212, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--color-bg-main);
            color: var(--color-text-dark);
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .hero-image {
            height: 445px;
            object-fit: cover;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            width: 100%;
            max-width: 680px;
        }

        .btn-hover-lift:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px var(--color-primary-shadow);
        }

        .smooth-transition {
            transition: all 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        .card-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.8);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: var(--color-bg-surface);
            padding: 2rem;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .admin-dashboard {
            background-color: var(--color-bg-surface);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .navbar {
            background-color: #FFFCF5;
            border-bottom: 1px solid rgba(163, 125, 69, 0.15);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .hero-section {
            background: linear-gradient(to bottom, rgba(252, 249, 243, 0.95), rgba(252, 249, 243, 0.98));
            padding: 4rem 1.5rem;
            margin-bottom: 3rem;
        }

        .hero-title {
            font-family: 'Satisfy', cursive;
            font-size: 4rem;
            color: #1a1a1a;
            text-align: center;
            margin-bottom: 1.5rem;
            font-weight: 400;
            line-height: 1.2;
        }

        .hero-subtitle {
            color: #5a5a5a;
            text-align: center;
            font-size: 1.125rem;
            max-width: 900px;
            margin: 0 auto 2.5rem;
            font-weight: 400;
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
        }
    </style>
</head>

<body class="min-h-screen">
    <header class="sticky top-0 z-50 navbar shadow-md">
        <nav class="container mx-auto px-6 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <h1 class="text-3xl font-heading font-extrabold tracking-wide" style="color: #A37D45;">
                    Bakes-Villa
                </h1>
            </div>

            <ul class="hidden md:flex gap-8 text-lg font-semibold">
                <li><a href="#hero" class="smooth-transition" style="color: #72543D;" onmouseover="this.style.color='#A37D45'" onmouseout="this.style.color='#72543D'">Our Story</a></li>
                <li><a href="#collection-section" class="smooth-transition" style="color: #72543D;" onmouseover="this.style.color='#A37D45'" onmouseout="this.style.color='#72543D'">Collection</a></li>
                <li><a href="#contact" class="smooth-transition" style="color: #72543D;" onmouseover="this.style.color='#A37D45'" onmouseout="this.style.color='#72543D'">Call Us</a></li>
            </ul>

            <div class="flex items-center gap-3">
                <button id="theme-toggle" class="p-2 rounded-full smooth-transition" style="background-color: rgba(114, 84, 61, 0.2);" title="Toggle dark mode">
                    <svg id="theme-icon-sun" class="w-6 h-6 hidden" style="color: #A37D45;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <svg id="theme-icon-moon" class="w-6 h-6" style="color: #A37D45;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                </button>

                <button id="staff-login-btn" class="px-6 py-2 rounded-full font-semibold smooth-transition shadow-md" style="background-color: #333333; color: white;">
                    Staff Login
                </button>
            </div>

            <button id="mobile-menu-toggle" class="md:hidden" style="color: #A37D45;">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </nav>

        <div id="mobile-menu" class="hidden md:hidden navbar border-t px-6 py-4" style="border-color: rgba(163, 125, 69, 0.2);">
            <ul class="flex flex-col gap-4">
                <li><a href="#hero" style="color: #72543D;">Our Story</a></li>
                <li><a href="#collection-section" style="color: #72543D;">Collection</a></li>
                <li><a href="#contact" style="color: #72543D;">Call Us</a></li>
            </ul>
        </div>
    </header>

    <div id="login-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-heading font-bold" style="color: #A37D45;">Staff Login</h2>
                <button id="close-login" class="text-3xl" style="color: #72543D;">&times;</button>
            </div>
            <div id="login-error" class="hidden bg-red-100 text-red-700 p-3 rounded-lg mb-4"></div>
            <input type="text" id="username" placeholder="Username" class="w-full p-3 mb-4 rounded-lg border-2 focus:outline-none" style="border-color: rgba(163, 125, 69, 0.3); background-color: var(--color-bg-main); color: var(--color-text-dark);">
            <input type="password" id="password" placeholder="Password" class="w-full p-3 mb-6 rounded-lg border-2 focus:outline-none" style="border-color: rgba(163, 125, 69, 0.3); background-color: var(--color-bg-main); color: var(--color-text-dark);">
            <button id="login-submit" class="w-full py-3 rounded-full font-bold smooth-transition" style="background-color: #A37D45; color: white;">
                Login
            </button>
        </div>
    </div>

    <div id="admin-dashboard" class="hidden container mx-auto px-6 py-12">
        <div class="admin-dashboard">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-4xl font-heading font-bold" style="color: #A37D45;">Admin Dashboard</h2>
                <button id="logout-btn" class="bg-red-500 text-white px-6 py-2 rounded-full font-semibold hover:bg-red-600 smooth-transition">
                    Logout
                </button>
            </div>

            <div class="mb-8">
                <h3 class="text-2xl font-heading font-bold mb-4" style="color: #A37D45;">Add New Cake</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <input type="text" id="cake-name" placeholder="Cake Name" class="p-3 rounded-lg border-2" style="border-color: rgba(163, 125, 69, 0.3); background-color: var(--color-bg-main); color: var(--color-text-dark);">
                    <input type="number" id="cake-price" placeholder="Price (‚Çπ)" class="p-3 rounded-lg border-2" style="border-color: rgba(163, 125, 69, 0.3); background-color: var(--color-bg-main); color: var(--color-text-dark);">
                </div>
                <textarea id="cake-description" placeholder="Description" rows="3" class="w-full mt-4 p-3 rounded-lg border-2" style="border-color: rgba(163, 125, 69, 0.3); background-color: var(--color-bg-main); color: var(--color-text-dark);"></textarea>
                <input type="file" id="cake-image" accept="image/*" capture="environment" class="w-full mt-4 p-3 rounded-lg border-2" style="border-color: rgba(163, 125, 69, 0.3); background-color: var(--color-bg-main); color: var(--color-text-dark);">
                <button id="add-cake-btn" class="mt-4 px-8 py-3 rounded-full font-bold smooth-transition" style="background-color: #A37D45; color: white;">
                    Add Cake
                </button>
            </div>

            <div>
                <h3 class="text-2xl font-heading font-bold mb-4" style="color: #A37D45;">Manage Cakes</h3>
                <div id="admin-cakes-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                </div>
            </div>
        </div>
    </div>

    <main id="main-content" class="container mx-auto px-6 py-12">
        <section id="hero" class="mb-20 fade-in">
            <div class="hero-section">
                <h2 class="hero-title">
                    Excellence Baked Daily
                </h2>
                <p class="hero-subtitle">
                    Discover the art of artisan baking. Every creation is handcrafted for pure, gourmet satisfaction.
                </p>

                <img src="https://britishbakels.b-cdn.net/wp-content/uploads/sites/2/2022/06/feature-680x445.jpg" 
                     alt="Delicious Pastries with Powdered Sugar" 
                     class="w-full hero-image mx-auto">

                <div class="text-center mt-10">
                    <a href="#collection-section" class="inline-block px-10 py-4 rounded-full text-lg font-bold shadow-lg smooth-transition btn-hover-lift" style="background-color: #A37D45; color: white;">
                        Explore the Collection
                    </a>
                </div>
            </div>
        </section>

        <section id="about-section" class="mb-20 pt-10">
            <h3 class="text-4xl font-heading font-extrabold mb-12 text-center pb-3 max-w-sm mx-auto" style="color: #A37D45; border-bottom: 2px solid rgba(163, 125, 69, 0.3);">
                Our Commitment
            </h3>
            
            <div class="grid md:grid-cols-3 gap-10 max-w-6xl mx-auto text-center">
                <div class="p-6 rounded-lg shadow-md card-hover" style="background-color: var(--color-bg-surface);">
                    <div class="mx-auto mb-4" style="color: #A37D45;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-16 h-16 mx-auto">
                            <path d="M12 2L4 7v10c0 5.5 3.8 10 8 11 4.2-1 8-5.5 8-11V7l-8-5z"/>
                        </svg>
                    </div>
                    <h4 class="text-2xl font-heading font-bold mb-3" style="color: #A37D45;">Finest Ingredients</h4>
                    <p style="color: #72543D;">
                        We source only premium, fresh ingredients to ensure every bite is perfection.
                    </p>
                </div>

                <div class="p-6 rounded-lg shadow-md card-hover" style="background-color: var(--color-bg-surface);">
                    <div class="mx-auto mb-4" style="color: #A37D45;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-16 h-16 mx-auto">
                            <path d="M12 2c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm7 9c0-3.9-3.1-7-7-7s-7 3.1-7 7c0 2.4 1.2 4.5 3 5.7V22h8v-5.3c1.8-1.2 3-3.3 3-5.7z"/>
                        </svg>
                    </div>
                    <h4 class="text-2xl font-heading font-bold mb-3" style="color: #A37D45;">Handcrafted Excellence</h4>
                    <p style="color: #72543D;">
                        Each cake is meticulously crafted by our skilled bakers with passion and precision.
                    </p>
                </div>

                <div class="p-6 rounded-lg shadow-md card-hover" style="background-color: var(--color-bg-surface);">
                    <div class="mx-auto mb-4" style="color: #A37D45;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-16 h-16 mx-auto">
                            <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                        </svg>
                    </div>
                    <h4 class="text-2xl font-heading font-bold mb-3" style="color: #A37D45;">Made Fresh Daily</h4>
                    <p style="color: #72543D;">
                        Baked fresh every morning to deliver the ultimate taste and quality.
                    </p>
                </div>
            </div>
        </section>

        <section id="collection-section" class="mb-20 pt-10">
            <h3 class="text-4xl font-heading font-extrabold mb-12 text-center pb-3 max-w-md mx-auto" style="color: #A37D45; border-bottom: 2px solid rgba(163, 125, 69, 0.3);">
                Shop Our Cakes
            </h3>
            
            <div id="collection-loading" class="text-center py-12">
                <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2" style="border-color: #A37D45;"></div>
                <p class="mt-4 text-lg" style="color: #72543D;">Loading our delicious cakes...</p>
            </div>

            <div id="collection-grid" class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto hidden">
            </div>

            <div id="collection-empty" class="text-center py-12 hidden">
                <p class="text-lg" style="color: #72543D;">No cakes available at the moment. Check back soon!</p>
            </div>
        </section>

        <section id="our-story-section" class="mb-20 pt-10">
            <h3 class="text-4xl font-heading font-extrabold mb-12 text-center pb-3 max-w-xs mx-auto" style="color: #A37D45; border-bottom: 2px solid rgba(163, 125, 69, 0.3);">
                Our Story
            </h3>
            
            <div id="our-story-content" class="max-w-4xl mx-auto text-lg leading-relaxed p-8 rounded-lg shadow-md" style="color: #72543D; background-color: var(--color-bg-surface);">
                <p class="mb-4">
                    At Bakes-Villa, every cake tells a story of passion, tradition, and artistry. Founded by artisan bakers who believe in the power of quality ingredients and time-honored techniques, we've been creating memorable moments through our handcrafted cakes.
                </p>
                <p class="mb-4">
                    Our journey began with a simple belief: great cakes start with great ingredients. We work directly with local suppliers to source the finest butter, flour, and seasonal fruits, ensuring every creation meets our exacting standards.
                </p>
                <p>
                    Today, Bakes-Villa continues to honor that tradition, baking fresh every day and bringing joy to celebrations across the community. From birthdays to weddings, our cakes are crafted to make your special moments unforgettable.
                </p>
            </div>
        </section>

        <section id="contact" class="mb-20 pt-10">
            <h3 class="text-4xl font-heading font-extrabold mb-12 text-center pb-3 max-w-xs mx-auto" style="color: #A37D45; border-bottom: 2px solid rgba(163, 125, 69, 0.3);">
                Call Us
            </h3>
            
            <div class="max-w-2xl mx-auto text-center p-10 rounded-lg shadow-lg" style="background-color: var(--color-bg-surface);">
                <p class="text-xl mb-6" style="color: #72543D;">
                    Ready to order your perfect cake? Get in touch with us today!
                </p>
                
                <div class="space-y-4">
                    <div class="flex items-center justify-center gap-3">
                        <svg class="w-6 h-6" style="color: #A37D45;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                        </svg>
                        <a href="tel:+917543060400" class="text-2xl font-bold smooth-transition" style="color: #A37D45;">
                            +91 754 306 0400
                        </a>
                    </div>
                    
                    <div class="flex items-center justify-center gap-3">
                        <svg class="w-6 h-6" style="color: #A37D45;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                        </svg>
                        <a href="mailto:bakesvillaindia@gmail.com" class="text-xl smooth-transition" style="color: #A37D45;">
                            bakesvillaindia@gmail.com
                        </a>
                    </div>
                </div>

                <div class="mt-8">
                    <a href="tel:+917543060400" class="inline-block px-8 py-3 rounded-full text-lg font-bold shadow-lg smooth-transition btn-hover-lift" style="background-color: #A37D45; color: white;">
                        Call Now
                    </a>
                </div>
            </div>
        </section>
    </main>

    <footer class="py-8 mt-20" style="background-color: #333333; color: white;">
        <div class="container mx-auto px-6 text-center">
            <p class="text-lg font-heading mb-2">Bakes-Villa</p>
            <p class="text-sm opacity-80">&copy; 2025 Bakes-Villa. All rights reserved. | Baked with ‚ù§Ô∏è</p>
        </div>
    </footer>

    <script>
        let isAdminLoggedIn = false;

        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;
        const sunIcon = document.getElementById('theme-icon-sun');
        const moonIcon = document.getElementById('theme-icon-moon');

        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') {
            html.classList.add('dark');
            sunIcon.classList.remove('hidden');
            moonIcon.classList.add('hidden');
        }

        themeToggle.addEventListener('click', () => {
            html.classList.toggle('dark');
            const isDark = html.classList.contains('dark');
            
            if (isDark) {
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
                localStorage.setItem('theme', 'dark');
            } else {
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
                localStorage.setItem('theme', 'light');
            }
        });

        const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');

        mobileMenuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        const staffLoginBtn = document.getElementById('staff-login-btn');
        const loginModal = document.getElementById('login-modal');
        const closeLogin = document.getElementById('close-login');
        const loginSubmit = document.getElementById('login-submit');
        const loginError = document.getElementById('login-error');

        staffLoginBtn.addEventListener('click', () => {
            loginModal.classList.add('active');
        });

        closeLogin.addEventListener('click', () => {
            loginModal.classList.remove('active');
            loginError.classList.add('hidden');
        });

        loginModal.addEventListener('click', (e) => {
            if (e.target === loginModal) {
                loginModal.classList.remove('active');
                loginError.classList.add('hidden');
            }
        });

        loginSubmit.addEventListener('click', () => {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === 'siddhijain' && password === 'siddhijain12') {
                isAdminLoggedIn = true;
                loginModal.classList.remove('active');
                document.getElementById('main-content').classList.add('hidden');
                document.getElementById('admin-dashboard').classList.remove('hidden');
                loadAdminCakes();
            } else {
                loginError.textContent = 'Invalid username or password';
                loginError.classList.remove('hidden');
            }
        });

        document.getElementById('logout-btn').addEventListener('click', () => {
            isAdminLoggedIn = false;
            document.getElementById('main-content').classList.remove('hidden');
            document.getElementById('admin-dashboard').classList.add('hidden');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        });

        document.getElementById('add-cake-btn').addEventListener('click', async () => {
            const name = document.getElementById('cake-name').value;
            const price = document.getElementById('cake-price').value;
            const description = document.getElementById('cake-description').value;
            const imageFile = document.getElementById('cake-image').files[0];

            if (!name || !price || !description) {
                alert('Please fill all fields');
                return;
            }

            let imageUrl = 'https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400&q=80';

            if (imageFile) {
                const reader = new FileReader();
                reader.onloadend = async function() {
                    imageUrl = reader.result;
                    await saveCake(name, price, description, imageUrl);
                }
                reader.readAsDataURL(imageFile);
            } else {
                await saveCake(name, price, description, imageUrl);
            }
        });

        async function saveCake(name, price, description, imageUrl) {
            try {
                const { data, error } = await window.supabaseClient
                    .from(window.SUPABASE_TABLE_NAME)
                    .insert([{
                        name: name,
                        price: parseFloat(price),
                        description: description,
                        imageData: imageUrl
                    }]);

                if (error) throw error;

                alert('Cake added successfully!');
                document.getElementById('cake-name').value = '';
                document.getElementById('cake-price').value = '';
                document.getElementById('cake-description').value = '';
                document.getElementById('cake-image').value = '';
                
                loadAdminCakes();
                loadCollection();
            } catch (error) {
                console.error('Error adding cake:', error);
                alert('Error adding cake: ' + error.message);
            }
        }

        async function loadAdminCakes() {
            try {
                const { data: cakes, error } = await window.supabaseClient
                    .from(window.SUPABASE_TABLE_NAME)
                    .select('*')
                    .order('id', { ascending: false });

                if (error) throw error;

                const adminCakesList = document.getElementById('admin-cakes-list');
                adminCakesList.innerHTML = '';

                cakes.forEach(cake => {
                    const cakeCard = document.createElement('div');
                    cakeCard.className = 'rounded-lg shadow-md overflow-hidden';
                    cakeCard.style.backgroundColor = 'var(--color-bg-main)';
                    cakeCard.innerHTML = `
                        <img src="${cake.imageData || cake.image_url}" alt="${cake.name}" class="w-full h-48 object-cover">
                        <div class="p-4">
                            <h4 class="text-xl font-heading font-bold mb-2" style="color: #A37D45;">${cake.name}</h4>
                            <p class="text-sm mb-2" style="color: #72543D;">${cake.description}</p>
                            <p class="text-lg font-bold mb-3" style="color: #A37D45;">‚Çπ${cake.price}</p>
                            <button onclick="deleteCake('${cake.id}')" class="w-full bg-red-500 text-white py-2 rounded-lg hover:bg-red-600 smooth-transition">
                                Delete
                            </button>
                        </div>
                    `;
                    adminCakesList.appendChild(cakeCard);
                });
            } catch (error) {
                console.error('Error loading admin cakes:', error);
            }
        }

        window.deleteCake = async function(cakeId) {
            if (!confirm('Are you sure you want to delete this cake?')) return;

            try {
                const { error } = await window.supabaseClient
                    .from(window.SUPABASE_TABLE_NAME)
                    .delete()
                    .eq('id', cakeId);

                if (error) throw error;

                alert('Cake deleted successfully!');
                loadAdminCakes();
                loadCollection();
            } catch (error) {
                console.error('Error deleting cake:', error);
                alert('Error deleting cake: ' + error.message);
            }
        }

        window.initializeApp = async function() {
            console.log('üöÄ Initializing Bakes-Villa app...');
            await loadCollection();
            console.log('‚úÖ App initialized successfully');
        };

        async function loadCollection() {
            const loadingEl = document.getElementById('collection-loading');
            const gridEl = document.getElementById('collection-grid');
            const emptyEl = document.getElementById('collection-empty');
            
            try {
                console.log('Fetching from table:', window.SUPABASE_TABLE_NAME);
                
                const { data: cakes, error } = await window.supabaseClient
                    .from(window.SUPABASE_TABLE_NAME)
                    .select('*');
                
                if (error) {
                    console.error('Supabase Error:', error);
                    alert('Error loading cakes: ' + error.message + '\n\nPlease check: 1) Table name is correct 2) RLS policies allow SELECT');
                    loadingEl.classList.add('hidden');
                    emptyEl.classList.remove('hidden');
                    return;
                }
                
                loadingEl.classList.add('hidden');
                
                if (!cakes || cakes.length === 0) {
                    emptyEl.classList.remove('hidden');
                    return;
                }
                
                gridEl.classList.remove('hidden');
                gridEl.innerHTML = '';
                
                cakes.forEach(cake => {
                    const cakeCard = document.createElement('div');
                    cakeCard.className = 'rounded-lg shadow-lg overflow-hidden card-hover fade-in';
                    cakeCard.style.backgroundColor = 'var(--color-bg-surface)';
                    
                    cakeCard.innerHTML = `
                        <img src="${cake.imageData || 'https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=400&q=80'}" 
                             alt="${cake.name || 'Delicious Cake'}" 
                             class="w-full h-64 object-cover">
                        <div class="p-6">
                            <h4 class="text-2xl font-heading font-bold mb-2" style="color: #A37D45;">${cake.name || 'Specialty Cake'}</h4>
                            <p class="mb-4" style="color: #72543D;">${cake.description || 'A delicious handcrafted cake.'}</p>
                            <div class="flex justify-between items-center mt-4">
                                <span class="text-2xl font-bold" style="color: #A37D45;">‚Çπ${cake.price || '500'}</span>
                                <a href="tel:+917543060400" class="px-4 py-2 rounded-lg smooth-transition font-semibold" style="background-color: #333333; color: white;">
                                    Order Now
                                </a>
                            </div>
                        </div>
                    `;
                    
                    gridEl.appendChild(cakeCard);
                });
                
            } catch (error) {
                console.error('Error loading cakes:', error);
                loadingEl.classList.add('hidden');
                emptyEl.classList.remove('hidden');
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', window.onloadCallback);
        } else {
            window.onloadCallback();
        }

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    mobileMenu.classList.add('hidden');
                }
            });
        });
    </script>
</body>
</html>

